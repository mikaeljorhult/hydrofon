"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[773],{880:(e,t,i)=>{var n=i(306);const s={initialized:!1};var r=i(6);var a=i(496),o=i.n(a);var l={};l.create=function(e,t,i){return n={x:e/i,y:t},[o().createSnapGrid(n)];var n};const d=l;var c={grid:null,size:null,timestamps:null},u={x:0,y:0},m=null;c.resource=function(e){o().isSet(e)||(o()(e).dropzone({listeners:{dragenter:function(e){e.target.classList.add("droppable")},dragleave:function(e){e.target.classList.remove("droppable")},drop:function(e){var t=e.target,i=e.relatedTarget,n={id:parseInt(i.dataset.id),user_id:parseInt(i.dataset.user),start_time:parseInt(i.dataset.start),end_time:parseInt(i.dataset.end),resource_id:parseInt(t.dataset.id)},s=Math.round((i.getBoundingClientRect().left-t.getBoundingClientRect().left)/t.clientWidth*c.timestamps.duration+c.timestamps.start),r=n.end_time-(n.start_time-s);n.start_time=s,n.end_time=r;var a=document.createElement("div");a.classList.add("progress"),i.appendChild(a),t.dispatchEvent(new CustomEvent(e.dragEvent.altKey?"createbooking":"updatebooking",{detail:n})),i.classList.remove("droppable"),u={x:0,y:0}}}}),o()(e).on("doubletap",(function(e){if(e.target.classList.contains("segel-resource")||e.target.classList.contains("segel-bookings")){var t=e.target.classList.contains("segel-resource")?e.target:e.target.parentNode,i=Math.round(e.offsetX/t.clientWidth*c.timestamps.duration),n=Math.round(c.timestamps.duration/c.steps),s=i+c.timestamps.start,r=s+2*n;t.dispatchEvent(new CustomEvent("createbooking",{detail:{resource_id:[parseInt(t.dataset.id)],start_time:s,end_time:r}}))}})))},c.booking=function(e){!o().isSet(e)&&e.classList.contains("editable")?(o()(e).draggable({listeners:{start:function(e){e.altKey&&(m=e.target.cloneNode(!1),e.target.parentNode.appendChild(m)),e.target.classList.add("is-dragging")},move:function(e){u.x+=e.dx,u.y+=e.dy,e.target.style.transform="translate(".concat(u.x,"px, ").concat(u.y,"px)")},end:function(e){e.target.classList.remove("is-dragging"),m&&(e.altKey?c.booking(m):m.parentNode.removeChild(m),m=null)}},modifiers:[o().modifiers.restrict({restriction:".segel-resources"}),o().modifiers.snap({targets:c.grid,offset:"parent",relativePoints:[{x:0,y:0}]})]}),o()(e).resizable({edges:{top:!1,bottom:!1,left:".segel-resize-handle__left",right:".segel-resize-handle__right"},listeners:{start:function(e){e.target.classList.add("is-resizing")},move:function(e){var t=e.target.dataset,i=t.x,n=t.y;i=(parseFloat(i)||0)+e.deltaRect.left,n=(parseFloat(n)||0)+e.deltaRect.top,Object.assign(e.target.style,{width:"".concat(e.rect.width,"px"),height:"".concat(e.rect.height,"px"),transform:"translate(".concat(i,"px, ").concat(n,"px)")}),Object.assign(e.target.dataset,{x:i,y:n})},end:function(e){var t=e.target,i=t.parentNode,n=t.dataset.x;n=parseFloat(n)||0;var s={id:parseInt(t.dataset.id),user_id:parseInt(t.dataset.user),start_time:parseInt(t.dataset.start),end_time:parseInt(t.dataset.end),resource_id:parseInt(i.dataset.id)},r=Math.round((t.getBoundingClientRect().left-i.getBoundingClientRect().left)/i.clientWidth*c.timestamps.duration+c.timestamps.start),a=Math.round(t.getBoundingClientRect().width/i.clientWidth*c.timestamps.duration+r);s.start_time=r,s.end_time=a;var o=document.createElement("div");o.classList.add("progress"),t.appendChild(o),i.parentNode.dispatchEvent(new CustomEvent("updatebooking",{detail:s})),e.target.classList.remove("is-resizing")}},modifiers:[o().modifiers.restrict({restriction:".segel-resources"}),o().modifiers.restrictSize(c.size),o().modifiers.snap({targets:c.grid,offset:"startCoords"})]}),o()(e).on("doubletap",(function(e){e.target.classList.contains("segel-booking")&&e.target.closest(".segel-resource").dispatchEvent(new CustomEvent("deletebooking",{detail:{id:parseInt(e.target.dataset.id)}}))}))):e.classList.contains("editable")||o()(e).unset()};const h=c;function f(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw r}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var v=i(667);n.Z.data("resourceTree",(function(e){var t,i,n;return{visible:null===(t=e.visible)||void 0===t||t,expanded:null!==(i=e.expanded)&&void 0!==i?i:[],selected:null!==(n=e.selected)&&void 0!==n?n:[],date:e.date,datepicker:null,debounceExpanded:null,debounceSelected:null,multipleSelect:function(e){if(!e.target.classList.contains("hidden")&&e.altKey){var t=e.target.closest(".resourcelist-category"),i=Array.from(t.querySelectorAll(":scope > .resourcelist-children > .resourcelist-resource input")),n=i.filter((function(e){return e.checked}));if(i.length===n.length){var s=n.map((function(e){return e.value}));this.selected=this.selected.filter((function(e){return-1===s.indexOf(e)}))}else{var r=i.filter((function(e){return!e.checked})).map((function(e){return e.value}));this.selected=this.selected.concat(r)}e.preventDefault()}},init:function(){var e=this;this.$watch("expanded",(function(t){s.initialized&&(clearTimeout(e.debounceExpanded),e.debounceExpanded=setTimeout((function(){e.$dispatch("segel-setexpanded",t)}),1e3))})),this.$watch("selected",(function(t){clearTimeout(e.debounceSelected),e.debounceSelected=setTimeout((function(){s.initialized?e.$dispatch("segel-setresources",t):e.$refs.form.submit()}),1e3)})),window.livewire.on("dateChanged",(function(t){e.date=t.date,e.datepicker.setDate(e.date,!1)})),this.datepicker=flatpickr(this.$refs.datepicker,{allowInput:!0,altFormat:"Y-m-d",dateFormat:"Y-m-d",time_24hr:!0,onChange:function(t,i,n){var r=new Date(t[0].getTime()-60*t[0].getTimezoneOffset()*1e3).getTime()/1e3;s.initialized?e.$dispatch("segel-settimestamps",{start:r}):e.$refs.form.submit()}})}}})),n.Z.data("qrScanner",(function(e){return{isOpen:!1,isScanning:!1,hasCamera:!1,lastCode:{},scanner:null,init:function(){this.hasCamera=r.Z.hasCamera(),this.hasCamera&&(this.scanner=new r.Z(this.$refs.video,this.onDecode.bind(this),{returnDetailedScanResult:!0,highlightScanRegion:!0,overlay:this.$refs.highlight}))},start:function(){this.scanner.start(),this.isScanning=!0},stop:function(){this.scanner.stop(),this.isScanning=!1,this.isOpen=!1},onDecode:function(e){if(e.data.startsWith("hydrofon:")){var t=e.data.substring(9);this.codeShouldBeProcessed(t)&&(this.lastCode={id:t,readAt:new Date},console.log("Valid QR Code",t),this.$dispatch("qrcoderead",t))}else console.log("Invalid QR Code")},codeShouldBeProcessed:function(e){return this.lastCode.id===e&&new Date-this.lastCode.readAt>3e4&&(this.lastCode={}),e!==this.lastCode.id},outsideClick:function(){this.isOpen&&(this.isOpen=!1)}}})),n.Z.data("segel",(function(e){var t,i;return{start:e.start,duration:e.duration,steps:e.steps,current:0,selected:[],rulerElement:null,init:function(){var e=this;this.rulerElement=this.$el.querySelector(".segel-ruler"),setInterval((function(){e.current=Math.round(((new Date).getTime()-60*(new Date).getTimezoneOffset()*1e3)/1e3)}),1e3),this.setupTimestamps(),this.calculateGrid(),this.setupInteractions(),this.$watch("start, duration, steps",this.setupTimestamps.bind(this)),window.Livewire.hook("message.processed",(function(t,i){"segel"===i.name&&(e.setupInteractions(),e.diffSelected())})),Array.prototype.forEach.call(this.$el.querySelectorAll('[name="selected[]"]'),(function(e){e.checked=!1})),s.initialized=!0},base:(t={},g(t,"x-on:resize.window.debounce.500",(function(){this.handleResize()})),g(t,"x-on:segel-setexpanded.window",(function(e){this.$wire.setExpanded(e.detail)})),g(t,"x-on:segel-setresources.window",(function(e){this.$wire.setResources(e.detail)})),g(t,"x-on:segel-settimestamps.window",(function(e){this.$wire.setTimestamps(e.detail)})),t),selector:(i={},g(i,"x-on:click",(function(){this.$el.checked?this.selected.push(this.$el.value):this.selected.splice(this.selected.indexOf(this.$el.value),1)})),g(i,"x-bind:checked",(function(){return this.selected.indexOf(this.$el.value)>-1})),i),diffSelected:function(){var e=this.$el.querySelectorAll('[name="selected[]"]'),t=Array.from(e).map((function(e){return e.value}));this.selected=this.selected.filter((function(e){return t.includes(e)}))},setupTimestamps:function(){h.steps=this.steps,h.timestamps={start:this.start,duration:this.duration}},setupInteractions:function(){this.$el.querySelectorAll(".segel-resource").forEach(h.resource),this.$el.querySelectorAll(".segel-booking").forEach(h.booking)},calculateGrid:function(){var e=window.getComputedStyle(this.rulerElement,null).getPropertyValue("padding-left").replace("px",""),t=this.$el.clientWidth-parseInt(e);h.grid=d.create(t,44,this.steps),h.size={min:{width:t/this.steps,height:1},max:{width:t,height:44}}},handleResize:function(){this.calculateGrid();var e,t=f(this.$el.querySelectorAll(".segel-booking"));try{for(t.s();!(e=t.n()).done;){var i=e.value;if(o().isSet(i)){var n=o()(i).draggable(),s=o()(i).resizable();n.modifiers[1].options.targets=h.grid,s.modifiers[2].options.targets=h.grid,s.modifiers[1].options.min=h.size.min,s.modifiers[1].options.max=h.size.max}}}catch(e){t.e(e)}finally{t.f()}}}})),n.Z.data("multiBook",(function(e){return{start_time:e.start_time,end_time:e.end_time,startTimeDatepicker:null,endTimeDatepicker:null,init:function(){var e=this;this.startTimeDatepicker=(0,v.Z)(this.$refs.start_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0,onChange:function(t,i,n){e.endTimeDatepicker.selectedDates[0]<t[0]&&e.endTimeDatepicker.setDate(t[0].getTime()+72e5),e.endTimeDatepicker.set("minDate",t[0])}}),this.endTimeDatepicker=(0,v.Z)(this.$refs.end_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0})},base:(t={},i="x-on:submit.prevent",n=function(){this.$root.dispatchEvent(new CustomEvent("createbooking",{detail:{resource_id:this.selected,start_time:new Date(this.start_time).getTime()/1e3,end_time:new Date(this.end_time).getTime()/1e3}}))},i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t)};var t,i,n})),n.Z.data("quickBook",(function(e){var t,i;return{isOpen:null!==(t=e.isOpen)&&void 0!==t&&t,start_time:e.start_time,end_time:e.end_time,resource_id:null!==(i=e.resource_id)&&void 0!==i?i:0,startTimeDatepicker:null,endTimeDatepicker:null,init:function(){var e=this;this.startTimeDatepicker=(0,v.Z)(this.$refs.start_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0,onChange:function(t,i,n){e.endTimeDatepicker.selectedDates[0]<t[0]&&e.endTimeDatepicker.setDate(t[0].getTime()+72e5),e.endTimeDatepicker.set("minDate",t[0])}}),this.endTimeDatepicker=(0,v.Z)(this.$refs.end_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0})},outsideClick:function(e){this.isOpen&&(e.target.closest(".flatpickr-calendar")||(this.isOpen=!1))}}})),n.Z.data("itemsTable",(function(e){return{selectedRows:e.selectedRows,init:function(){var e=this;this.$wire.on("editing",(function(){e.$el.querySelector(".is-editing").querySelector("select, input").focus()})),this.$refs.selectall.checked=!1,this.$watch("selectedRows",(function(t){var i=e.$root.querySelectorAll('[name="selected[]"]');e.$refs.selectall.checked=t.length===i.length&&i.length>0,e.$refs.selectall.indeterminate=t.length>0&&t.length!==i.length}))},selectall:(t={},i="x-on:click",n=function(){if(this.$el.checked){var e=this.$root.querySelectorAll('[name="selected[]"]');this.selectedRows=Array.from(e).map((function(e){return e.value}))}else this.selectedRows=[]},i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t)};var t,i,n})),window.Alpine=n.Z,n.Z.start(),window.interact=o(),window.flatpickr=v.Z},580:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[170,898],(()=>(t(880),t(580))));e.O()}]);