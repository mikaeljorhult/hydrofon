"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[773],{47:(e,t,i)=>{var n=i(306);const r={initialized:!1};var s=i(496),a=i.n(s);var o={};o.create=function(e,t,i){return n={x:e/i,y:t},[a().createSnapGrid(n)];var n};const d=o;var l={grid:null,size:null,timestamps:null},c={x:0,y:0},u=null;l.resource=function(e){a().isSet(e)||(a()(e).dropzone({listeners:{dragenter:function(e){e.target.classList.add("droppable")},dragleave:function(e){e.target.classList.remove("droppable")},drop:function(e){var t=e.target,i=e.relatedTarget,n={id:parseInt(i.dataset.id),user_id:parseInt(i.dataset.user),start_time:parseInt(i.dataset.start),end_time:parseInt(i.dataset.end),resource_id:parseInt(t.dataset.id)},r=Math.round((i.getBoundingClientRect().left-t.getBoundingClientRect().left)/t.clientWidth*l.timestamps.duration+l.timestamps.start),s=n.end_time-(n.start_time-r);n.start_time=r,n.end_time=s;var a=document.createElement("div");a.classList.add("progress"),i.appendChild(a),t.dispatchEvent(new CustomEvent(e.dragEvent.altKey?"createbooking":"updatebooking",{detail:n})),i.classList.remove("droppable"),c={x:0,y:0}}}}),a()(e).on("doubletap",(function(e){if(e.target.classList.contains("segel-resource")||e.target.classList.contains("segel-bookings")){var t=e.target.classList.contains("segel-resource")?e.target:e.target.parentNode,i=Math.round(e.offsetX/t.clientWidth*l.timestamps.duration),n=Math.round(l.timestamps.duration/l.steps),r=i+l.timestamps.start,s=r+2*n;t.dispatchEvent(new CustomEvent("createbooking",{detail:{resource_id:[parseInt(t.dataset.id)],start_time:r,end_time:s}}))}})))},l.booking=function(e){!a().isSet(e)&&e.classList.contains("editable")?(a()(e).draggable({listeners:{start:function(e){e.altKey&&(u=e.target.cloneNode(!1),e.target.parentNode.appendChild(u)),e.target.classList.add("is-dragging")},move:function(e){c.x+=e.dx,c.y+=e.dy,e.target.style.transform="translate(".concat(c.x,"px, ").concat(c.y,"px)")},end:function(e){e.target.classList.remove("is-dragging"),u&&(e.altKey?l.booking(u):u.parentNode.removeChild(u),u=null)}},modifiers:[a().modifiers.restrict({restriction:".segel-resources"}),a().modifiers.snap({targets:l.grid,offset:"parent",relativePoints:[{x:0,y:0}]})]}),a()(e).resizable({edges:{top:!1,bottom:!1,left:".segel-resize-handle__left",right:".segel-resize-handle__right"},listeners:{start:function(e){e.target.classList.add("is-resizing")},move:function(e){var t=e.target.dataset,i=t.x,n=t.y;i=(parseFloat(i)||0)+e.deltaRect.left,n=(parseFloat(n)||0)+e.deltaRect.top,Object.assign(e.target.style,{width:"".concat(e.rect.width,"px"),height:"".concat(e.rect.height,"px"),transform:"translate(".concat(i,"px, ").concat(n,"px)")}),Object.assign(e.target.dataset,{x:i,y:n})},end:function(e){var t=e.target,i=t.parentNode,n=t.dataset.x;n=parseFloat(n)||0;var r={id:parseInt(t.dataset.id),user_id:parseInt(t.dataset.user),start_time:parseInt(t.dataset.start),end_time:parseInt(t.dataset.end),resource_id:parseInt(i.dataset.id)},s=Math.round((t.getBoundingClientRect().left-i.getBoundingClientRect().left)/i.clientWidth*l.timestamps.duration+l.timestamps.start),a=Math.round(t.getBoundingClientRect().width/i.clientWidth*l.timestamps.duration+s);r.start_time=s,r.end_time=a;var o=document.createElement("div");o.classList.add("progress"),t.appendChild(o),i.parentNode.dispatchEvent(new CustomEvent("updatebooking",{detail:r})),e.target.classList.remove("is-resizing")}},modifiers:[a().modifiers.restrict({restriction:".segel-resources"}),a().modifiers.restrictSize(l.size),a().modifiers.snap({targets:l.grid,offset:"startCoords"})]}),a()(e).on("doubletap",(function(e){e.target.classList.contains("segel-booking")&&e.target.closest(".segel-resource").dispatchEvent(new CustomEvent("deletebooking",{detail:{id:parseInt(e.target.dataset.id)}}))}))):e.classList.contains("editable")||a()(e).unset()};const m=l;function p(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw s}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g=i(667);n.Z.data("resourceTree",(function(e){var t,i,n;return{visible:null===(t=e.visible)||void 0===t||t,expanded:null!==(i=e.expanded)&&void 0!==i?i:[],selected:null!==(n=e.selected)&&void 0!==n?n:[],date:e.date,datepicker:null,debounceExpanded:null,debounceSelected:null,multipleSelect:function(e){if(!e.target.classList.contains("hidden")&&e.altKey){var t=e.target.closest(".resourcelist-category"),i=Array.from(t.querySelectorAll(":scope > .resourcelist-children > .resourcelist-resource input")),n=i.filter((function(e){return e.checked}));if(i.length===n.length){var r=n.map((function(e){return e.value}));this.selected=this.selected.filter((function(e){return-1===r.indexOf(e)}))}else{var s=i.filter((function(e){return!e.checked})).map((function(e){return e.value}));this.selected=this.selected.concat(s)}e.preventDefault()}},init:function(){var e=this;this.$watch("expanded",(function(t){r.initialized&&(clearTimeout(e.debounceExpanded),e.debounceExpanded=setTimeout((function(){e.$dispatch("segel-setexpanded",t)}),1e3))})),this.$watch("selected",(function(t){clearTimeout(e.debounceSelected),e.debounceSelected=setTimeout((function(){r.initialized?e.$dispatch("segel-setresources",t):e.$refs.form.submit()}),1e3)})),window.livewire.on("dateChanged",(function(t){e.date=t.date,e.datepicker.setDate(e.date,!1)})),this.datepicker=flatpickr(this.$refs.datepicker,{allowInput:!0,altFormat:"Y-m-d",dateFormat:"Y-m-d",time_24hr:!0,onChange:function(t,i,n){var s=new Date(t[0].getTime()-60*t[0].getTimezoneOffset()*1e3).getTime()/1e3;r.initialized?e.$dispatch("segel-settimestamps",{start:s}):e.$refs.form.submit()}})}}})),n.Z.data("segel",(function(e){var t,i;return{start:e.start,duration:e.duration,steps:e.steps,current:0,selected:[],rulerElement:null,init:function(){var e=this;this.rulerElement=this.$el.querySelector(".segel-ruler"),setInterval((function(){e.current=Math.round(((new Date).getTime()-60*(new Date).getTimezoneOffset()*1e3)/1e3)}),1e3),this.setupTimestamps(),this.calculateGrid(),this.setupInteractions(),this.$watch("start, duration, steps",this.setupTimestamps),window.Livewire.hook("message.processed",(function(t,i){"segel"===i.name&&(e.setupInteractions(),e.diffSelected())})),Array.prototype.forEach.call(this.$el.querySelectorAll('[name="selected[]"]'),(function(e){e.checked=!1})),r.initialized=!0},base:(t={},h(t,"x-on:resize.window.debounce.500",(function(){this.handleResize()})),h(t,"x-on:segel-setexpanded.window",(function(e){this.$wire.setExpanded(e.detail)})),h(t,"x-on:segel-setresources.window",(function(e){this.$wire.setResources(e.detail)})),h(t,"x-on:segel-settimestamps.window",(function(e){this.$wire.setTimestamps(e.detail)})),t),selector:(i={},h(i,"x-on:click",(function(){this.$el.checked?this.selected.push(this.$el.value):this.selected.splice(this.selected.indexOf(this.$el.value),1)})),h(i,"x-bind:checked",(function(){return this.selected.indexOf(this.$el.value)>-1})),i),diffSelected:function(){var e=this.$el.querySelectorAll('[name="selected[]"]'),t=Array.from(e).map((function(e){return e.value}));this.selected=this.selected.filter((function(e){return t.includes(e)}))},setupTimestamps:function(){m.steps=this.steps,m.timestamps={start:this.start,duration:this.duration}},setupInteractions:function(){this.$el.querySelectorAll(".segel-resource").forEach(m.resource),this.$el.querySelectorAll(".segel-booking").forEach(m.booking)},calculateGrid:function(){var e=window.getComputedStyle(this.rulerElement,null).getPropertyValue("padding-left").replace("px",""),t=this.$el.clientWidth-parseInt(e);m.grid=d.create(t,44,this.steps),m.size={min:{width:t/this.steps,height:1},max:{width:t,height:44}}},handleResize:function(){this.calculateGrid();var e,t=p(this.$el.querySelectorAll(".segel-booking"));try{for(t.s();!(e=t.n()).done;){var i=e.value;if(a().isSet(i)){var n=a()(i).draggable(),r=a()(i).resizable();n.modifiers[1].options.targets=m.grid,r.modifiers[2].options.targets=m.grid,r.modifiers[1].options.min=m.size.min,r.modifiers[1].options.max=m.size.max}}}catch(e){t.e(e)}finally{t.f()}}}})),n.Z.data("multiBook",(function(e){return{start_time:e.start_time,end_time:e.end_time,startTimeDatepicker:null,endTimeDatepicker:null,init:function(){var e=this;this.startTimeDatepicker=(0,g.Z)(this.$refs.start_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0,onChange:function(t,i,n){e.endTimeDatepicker.selectedDates[0]<t[0]&&e.endTimeDatepicker.setDate(t[0].getTime()+72e5),e.endTimeDatepicker.set("minDate",t[0])}}),this.endTimeDatepicker=(0,g.Z)(this.$refs.end_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0})},base:(t={},i="x-on:submit.prevent",n=function(){this.$root.dispatchEvent(new CustomEvent("createbooking",{detail:{resource_id:this.selected,start_time:new Date(this.start_time).getTime()/1e3,end_time:new Date(this.end_time).getTime()/1e3}}))},i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t)};var t,i,n})),n.Z.data("quickBook",(function(e){var t,i;return{isOpen:null!==(t=e.isOpen)&&void 0!==t&&t,start_time:e.start_time,end_time:e.end_time,resource_id:null!==(i=e.resource_id)&&void 0!==i?i:0,startTimeDatepicker:null,endTimeDatepicker:null,init:function(){var e=this;this.startTimeDatepicker=(0,g.Z)(this.$refs.start_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0,onChange:function(t,i,n){e.endTimeDatepicker.selectedDates[0]<t[0]&&e.endTimeDatepicker.setDate(t[0].getTime()+72e5),e.endTimeDatepicker.set("minDate",t[0])}}),this.endTimeDatepicker=(0,g.Z)(this.$refs.end_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0})},outsideClick:function(e){this.isOpen&&(e.target.closest(".flatpickr-calendar")||(this.isOpen=!1))}}})),window.Alpine=n.Z,n.Z.start(),window.interact=a(),window.flatpickr=g.Z},580:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[170,898],(()=>(t(47),t(580))));e.O()}]);